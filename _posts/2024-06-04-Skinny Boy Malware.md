---
title: "Skinny Boy Malware"
date: 2024-06-27
categories: [Malware]
tags: [Malware, APT]
---

## A Deep Dive behind Skinny Boy

#### Introduction

Skinny boy was a new malware that was initially discovered by research group Cluster25 back in 2021. They linked Skinny Boy to APT 28 known as Fancy Bear, the group started their campaign at the beginning of March 2021 targeting a variety of different government systems. The malware has successfully managed to make its way into systems in both the EU and US. More recently in the summer of 2023 it was again discovered to be used in multiple spear phishing campaigns.

#### What even is it?

The malware is used during the intermediary stage of the campaign which is the step where it begins to get a foothold on the system. Skinny boy gathers information about the system it infected and awaits for instructions via payload from the C2 server.

#### Breakdown

The first step is the campaign is infecting the system, like every malware out there phishing and watering holes are common ways to infect a target's system. Skinny boy in particular uses a spear phishing campaign with a Microsoft Word document attachment in relation to “international conferences”. This is a well known strategy particularly coming from APT28 in attacking government systems. 

The document that is attached is maliciously crafted with a MACRO that extracts a particular DLL which is a downloader. The downloader then from the C2 url downloads the Skinny Boy dropper which begins the second stage of the attack. After the dropper is downloaded it immediately begins its persistence campaign. The dropper creates 2 different files in different locations as listed below and then deletes itself after the payload was decoded.

`C:\Users\%username%\AppData\Local\devtmrn.exe` 

`C:\Users\%username%\AppData\Local\Microsoft\TerminalServerClient\TermSrvClt.dll`

The Interesting part of this malware I found was how it evaded AV by not actually running the 2 files that were extracted from the dropper. It focuses on maintaining persistence first by creating a LNK file inside the startup folder to devtmrn.exe. After persistence is established when the system reboots the LNK that was placed launches the exe.

The devtmrn is actually just the launcher for the dll which is the main implant of the attack. The launcher simply checks if the file was created then births a new process calling the RunMod function from the DLL.

#### Main Implant

The TermSrvClt.dll is the main implant where all the fun stuff happens. It first gathers information of the infected system focusing on a few key directories as listed below. The information is packed together into a structure which then gets sent back to the C2 server encoded. After transmitting the gathered information to the C2 it requests the final payload. The malware employs another interesting evasion tactic by using 2 different XOR keys when building the C2 POST request. 

The C2 sends the last instruction for the final dll to run which creates the backdoor. The downloaded file from the C2 is injected and executed inside the memory as well as deleted to cover footprints.

The malware was quite simple and straightforward in terms of sophistication, it did not use any Zero Days or try high levels of obfuscation. But it was still able to successfully infect many systems. Personally I found this malware to be an excellent learning project as it used techniques I’ve read about in a different way and it was simple enough for me to still follow through.



